# “Нечто • Digital Companion” — Техническая спецификация

## 1. Общие сведения

| Пункт              | Содержимое                                                                 |
|--------------------|-----------------------------------------------------------------------------|
| Название проекта   | “Нечто • Digital Companion”                                                |
| Тип решения        | Web-приложение (PWA) + WebSocket-сервер                                   |
| Целевая аудитория  | 5–10 человек, играющих оффлайн за одним столом                            |
| Жизненный цикл     | MVP → Private Beta → Release (внутренний)                                 |

## 2. Цели и задачи

- Автоматизировать скрытые игровые механики (раздача ролей, фазы, события, паники, пересаживания, подсчёт победы).
- Сохранить живое общение: система не заменяет обсуждения и голос.
- Обеспечить единый UX на телефонах и ПК без установки из магазинов.

## 3. Область применения

- Игра проходит в одной физической комнате.
- Подключение через современный браузер по ссылке или QR-коду.
- Требуется доступ в интернет (WebSocket-сервер).

## 4. Требования к системе

### 4.1. Функциональные

**Лобби**
- Создание игры по клику “Новая игра” → генерация 6-символьного кода.
- Подключение игроков по коду / QR.
- Изменяемый список сидений (drag & drop).
- Проверка количества игроков и корректности сетапа.

**Старт партии**
- Случайная раздача скрытых ролей.
- Общий настраиваемый таймер подготовки (30–300 с).

**Игровые циклы**
- Чёткие фазы: Ночь → Обсуждение → Голосование → Событие/Паника.
- Система сама инициирует переходы, отображая подсказки.
- Возможность ручного Re-sync при сбоях.

**Карты и события**
- Пул карт на сервере.
- Поддержка пользовательских паков (импорт JSON).

**Пересаживания**
- Автоматическое предложение новой схемы сидений.
- Вывод схемы на все экраны + крупный QR-код.

**Завершение**
- Определение победившей стороны.
- Экран статистики (роли, действия, тайминги).
- Кнопка “Сыграть ещё” без выхода из лобби.

### 4.2. Нефункциональные

| Категория         | Цель                                                                 |
|-------------------|----------------------------------------------------------------------|
| Производительность| ≤ 150 мс отклик UI; ≤ 1 с переход фаз                                |
| Надёжность        | Автосохранение в Redis каждые 5 с; авто-reconnect                    |
| Безопасность      | TLS 1.3; хэш-ID игроков; роли по WSS — только адресату               |
| Масштабируемость  | До 20 параллельных лобби на 1 vCPU / 1 GiB сервер                    |
| Локализация       | RU (по умолчанию), EN — через i18n JSON-файлы                        |
| Доступность       | WCAG 2.1 AA: контраст, шрифты ≥ 14px, навигация без мыши             |

## 5. Архитектура и стек

### 5.1. Схема высокого уровня

